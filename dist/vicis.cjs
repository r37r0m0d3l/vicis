"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=["boolean","flag","numeric","integer","string","json"];function e(t,e){var r=e.get(t);if(!r)throw new TypeError("attempted to get private field on non-instance");return r.get?r.get.call(t):r.value}function r(t,e,r){var n=e.get(t);if(!n)throw new TypeError("attempted to set private field on non-instance");if(n.set)n.set.call(t,r);else{if(!n.writable)throw new TypeError("attempted to set read only private field");n.value=r}return r}function n(t,e){if(!t.length||!e.length)return[];const r=new Set(e);return[...new Set(t)].filter(t=>r.has(t))}function i(t,e){if(!t.length||!e.length)return!1;const r=new Set(e);return Boolean([...new Set(t)].filter(t=>r.has(t)).length)}const s=["cast","defaults","defined","exclude","omit","order","pick","sort","rename","replace","required","transform"];function o(t){return 0===Object.keys(t).length}function a(t){return null!==t&&"object"==typeof t&&!Array.isArray(t)}function c(t){return"string"==typeof t}function u(t){return JSON.stringify(t)}function h(e){if(!a(e))throw new TypeError("Cast should be an object");return o(e)?{}:(Object.keys(e).forEach(r=>{if(!c(e[r]))throw new TypeError(`'Cast' expect object values to be strings. Not a string at key: '${u(e[r])}'.`);if(!t.includes(e[r]))throw new TypeError(`'Cast' has unknown type in {${r}: "${e[r]}"}.`)}),e)}function f(t){if(null==t)return"";if("string"==typeof t)return t;const e=t.toString();return"0"===e&&Object.is(t,-0)?"-0":e}const l="boolean",y="flag",p="numeric",w="integer",b="string",d="json";function m(t){return JSON.parse(t)}function g(t){return"[object Function]"===Object.prototype.toString.call(t)&&!/^class\s/.test(Function.prototype.toString.call(t))}function E(t){return function(t){return c(t)?m(t):t}(function(t){let e;const{toJSON:r,toObject:n}=t;return e=g(n)?t.toObject():g(r)?t.toJSON():t,c(e)?e:u(e)}(t))}function j(t,e){return o(t)||Object.keys(t).forEach(r=>{const n=t[r];if(!(r in e))throw new Error(`Field '${r}' suppose to be converted to ${n}.`);switch(n){case l:e[r]=Boolean(e[r]);break;case y:e[r]=function(t,e=!1,r=!1){if(null==t)return e;if("boolean"==typeof t)return t;const n=t.toString().toLocaleLowerCase().trim();return 0===n.length?e:"true"===n||"1"===n||"false"!==n&&"0"!==n&&r}(e[r]);break;case p:{const t=Number(e[r]);if(Number.isFinite(t))e[r]=t;else{const t=Number.parseFloat(f(e[r]).trim());Number.isFinite(t)?e[r]=t:e[r]=0}break}case w:{const t=Number(e[r]);if(Number.isFinite(t))e[r]=Math.trunc(t);else{const n=Number.parseFloat(f(e[r]).trim());Number.isFinite(n)?e[r]=Math.trunc(t):e[r]=0}break}case b:e[r]=f(e[r]);break;case d:e[r]=E(e[r]);break;default:throw new Error("Unknown value convert error")}}),e}function k(t,e=!1){return e?function t(e,r=!0){if(!e||"object"!=typeof e||Array.isArray(e))return e;const n=Object.keys(e);return n.length?n.reduce((n,i)=>(r&&e[i]&&"object"==typeof e[i]&&!Array.isArray(e[i])?n[i]=t(e[i],r):n[i]=e[i],n),{}):e}(m(u(t)),!0):m(u(t))}function O(t){switch(v(t)){case"array":return t.slice();case"object":return Object.assign({},t);case"date":return new t.constructor(Number(t));case"map":return new Map(t);case"set":return new Set(t);case"buffer":return function(t){const e=t.length;let r;r=Buffer.allocUnsafe?Buffer.allocUnsafe(e):Buffer.from(e);return t.copy(r),r}(t);case"symbol":return function(t){if(Symbol.prototype.valueOf)return Object(Symbol.prototype.valueOf.call(t));return{}}(t);case"arraybuffer":return function(t){const e=new t.constructor(t.byteLength);return new Uint8Array(e).set(new Uint8Array(t)),e}(t);case"float32array":case"float64array":case"int16array":case"int32array":case"int8array":case"uint16array":case"uint32array":case"uint8clampedarray":case"uint8array":return function(t){return new t.constructor(t.buffer,t.byteOffset,t.length)}(t);case"regexp":return function(t){let e;e=void 0!==t.flags?t.flags:/\w+$/.exec(t)||void 0;const r=new t.constructor(t.source,e);return r.lastIndex=t.lastIndex,r}(t);case"error":return Object.create(t);default:return t}}function v(t){if(void 0===t)return"undefined";if(null===t)return"null";if(!0===t||!1===t||t instanceof Boolean)return"boolean";if("string"==typeof t||t instanceof String)return"string";if("number"==typeof t||t instanceof Number)return"number";if("function"==typeof t||t instanceof Function)return"function";if(void 0!==Array.isArray&&Array.isArray(t))return"array";if(t instanceof RegExp)return"regexp";if(t instanceof Date)return"date";var e,r=toString.call(t);return"[object RegExp]"===r?"regexp":"[object Date]"===r?"date":"[object Arguments]"===r?"arguments":"[object Error]"===r?"error":null!==(e=t)&&Boolean(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)?"buffer":"[object Set]"===r?"set":"[object WeakSet]"===r?"weakset":"[object Map]"===r?"map":"[object WeakMap]"===r?"weakmap":"[object Symbol]"===r?"symbol":"[object Int8Array]"===r?"int8array":"[object Uint8Array]"===r?"uint8array":"[object Uint8ClampedArray]"===r?"uint8clampedarray":"[object Int16Array]"===r?"int16array":"[object Uint16Array]"===r?"uint16array":"[object Int32Array]"===r?"int32array":"[object Uint32Array]"===r?"uint32array":"[object Float32Array]"===r?"float32array":"[object Float64Array]"===r?"float64array":"object"}function x(t){return!0===function(t){return"object"==typeof t&&null!==t}(t)&&"[object Object]"===Object.prototype.toString.call(t)}function A(t,e){switch(v(t)){case"object":return function(t,e){if("function"==typeof e)return e(t);if(e||function(t){let e,r;return!1!==x(t)&&(e=t.constructor,"function"==typeof e&&(r=e.prototype,!1!==x(r)&&!1!==r.hasOwnProperty("isPrototypeOf")))}(t)){const r=new t.constructor;for(let n in t)r[n]=A(t[n],e);return r}return t}(t,e);case"array":return function(t,e){const r=new t.constructor(t.length);for(let n=0;n<t.length;n++)r[n]=A(t[n],e);return r}(t,e);default:return O(t)}}function T(t){return function(t){return Object(t)!==t}(t)?t:A(t)}function S(t){if(!a(t))throw new TypeError("'Defaults' should be an object");return t}function N(t,e){return o(t)||Object.keys(t).forEach(r=>{r in e&&void 0!==e[r]||(e[r]=t[r])}),e}function $(t,e=!0){if(t.length<2)return t;let r=[...new Set(t)];if(r.includes(0)){const e=t.filter(t=>0===t);e.length>1&&e.some(t=>1/t===Number.NEGATIVE_INFINITY)&&r.push(-0)}if(r.filter(t=>"string"==typeof t).length){const e=t.filter(t=>"string"==typeof t);if(e.length>1){const t=[...new Set(e.map(t=>t.normalize()))];t.forEach(t=>{delete r[r.indexOf(t)]});const n=[];for(let t=0;t<r.length;t++)t in r&&n.push(r[t]);r=n.concat(t)}}return e?r.sort():r}function M(t){return 0===t.length}function F(t){if(!Array.isArray(t))throw new TypeError("'Defined' should be an array");return M(t)?[]:$(t).map(t=>{if(!c(t))throw new TypeError(`'Defined' expect array of strings. Value: '${u(t)}'.`);return t})}function W(t,e){const r=F(t);return M(r)||r.forEach(t=>{if(!(t in e))throw new Error(`Field '${t}' must be defined.`);if(void 0===e[t])throw new Error(`Field '${t}' should have value.`)}),e}function C(t){return t instanceof RegExp}function I(t){if(!Array.isArray(t))throw new TypeError("'Exclude' should be an array");return M(t)?[]:$(t).map(t=>{if(!c(t)&&!C(t))throw new TypeError(`'Exclude' expect array of strings or regular expressions. Value: '${u(t)}'.`);return t})}function R(t){return Object.keys(t).sort((t,e)=>t.localeCompare(e))}function J(t){if(!Array.isArray(t))throw new TypeError("'Omit' should be an array");return M(t)?[]:$(t).map(t=>{if(!c(t))throw new TypeError(`'Omit' expect array of strings. Value: '${u(t)}'.`);return t})}function U(t){if(!Array.isArray(t))throw new TypeError("'Order' should be an array");return M(t)?[]:$(t,!1).map(t=>{if(!c(t))throw new TypeError(`'Order' expect array of strings. Value: '${u(t)}'.`);return t})}function q(t,e=[],r=!1){if(!Array.isArray(e)||0===e.length)return t;const n=e.filter(t=>"string"==typeof t);let i=new Set(Object.keys(t));const s={};return n.forEach(e=>{i.delete(e),e in t&&(s[e]=t[e])}),i=[...i],r&&(i=i.sort((t,e)=>t.localeCompare(e))),i.forEach(e=>s[e]=t[e]),s}function B(t){if(!Array.isArray(t))throw new TypeError("'Pick' should be an array");return M(t)?[]:$(t).map(t=>{if(!c(t))throw new TypeError(`'Pick' expect array of strings. Value: '${u(t)}'.`);return t})}function D(t,e){if(M(t))return e;const r={};return Object.keys(e).forEach(n=>{t.includes(n)&&(r[n]=e[n])}),r}function V(t){if(!a(t))throw new TypeError("'Rename' should be an object");if(o(t))return{};Object.keys(t).forEach(t=>{if(!c(t))throw new TypeError(`'Rename' expect object values to be strings. Not a string at key: '${t}'.`)});const e=Object.values(t),r=$(e);if(e.length!==r.length)throw new TypeError(`'Rename' has similar values: '${u(r)}'.`);return t}function P(t,e){if(o(t))return e;const r=Object.keys(t).sort((t,e)=>t.localeCompare(e)),n={};return r.forEach(r=>{if(!(r in e))throw new Error(`Field '${r}' suppose to be renamed.`);n[t[r]]=e[r]}),r.forEach(t=>{delete e[t]}),Object.assign(e,n),e}function L(t){if(!a(t))throw new TypeError("'Replace' should be an object");return t}function G(t,e){return o(t)||Object.keys(t).forEach(r=>{e[r]=t[r]}),e}function _(t){if(!Array.isArray(t))throw new TypeError("'Required' should be an array");return M(t)?[]:$(t).map(t=>{if(!c(t))throw new TypeError(`'Required' expect array of strings. Value: '${u(t)}'.`);return t})}function Y(t,e){return M(t)||t.forEach(t=>{if(!(t in e))throw new Error(`Field '${t}' is required.`)}),e}function z(t){if(!a(t))throw new TypeError("'Transform' should be an object");return o(t)?{}:(Object.keys(t).forEach(e=>{if(!(r=t[e])||!(g(r)||"toFunction"in r&&g(r.toFunction)&&g(r.toFunction())))throw new TypeError(`'Transform' expect object values to be functions. Not a function at key: '${e}'.`);var r}),t)}function H(t,e){return o(t)||Object.keys(t).forEach(r=>{if(!(r in e))throw new Error(`Field '${r}' suppose to be transformed.`);g(t[r])?e[r]=t[r](e[r],r,T(e)):e[r]=t[r].toFunction()(e[r],r,T(e))}),e}class K{constructor(t={},s){Q.set(this,{writable:!0,value:{}}),X.set(this,{writable:!0,value:[]}),Z.set(this,{writable:!0,value:[]}),tt.set(this,{writable:!0,value:[]}),et.set(this,{writable:!0,value:[]}),rt.set(this,{writable:!0,value:[]}),nt.set(this,{writable:!0,value:[]}),it.set(this,{writable:!0,value:!1}),st.set(this,{writable:!0,value:{}}),ot.set(this,{writable:!0,value:{}}),at.set(this,{writable:!0,value:[]}),ct.set(this,{writable:!0,value:{}}),ut.set(this,{writable:!0,value:{}}),ht.set(this,{writable:!0,value:void 0}),ft.set(this,{writable:!0,value:void 0}),lt.set(this,{writable:!0,value:void 0}),r(this,ft,function(){const t=R(e(this,Q)),r=R(e(this,st)),s=R(e(this,ot)),o=R(e(this,ct));if(i(e(this,et),t))throw new Error(`'omit' has same keys as 'cast': ${n(e(this,et),t)}.`);if(i(e(this,et),e(this,Z)))throw new Error(`'omit' has same keys as 'defined': ${n(e(this,et),e(this,Z))}.`);if(i(e(this,et),e(this,nt)))throw new Error(`'omit' has same keys as 'pick': ${n(e(this,et),e(this,nt))}.`);if(i(e(this,et),r))throw new Error(`'omit' has same keys as 'rename': ${n(e(this,et),r)}.`);if(i(e(this,et),s))throw new Error(`'omit' has same keys as 'replace': ${n(e(this,et),s)}.`);if(i(e(this,et),e(this,at)))throw new Error(`'omit' has same keys as 'required': ${n(e(this,et),e(this,at))}.`);if(i(e(this,et),o))throw new Error(`'omit' has same keys as 'transform': ${n(e(this,et),o)}.`);if(i(e(this,et),o))throw new Error(`'omit' has same keys as 'transform': ${n(e(this,et),o)}.`);if(i(t,s))throw new Error(`'cast' has same keys as 'replace': ${n(t,s)}.`);if(i(t,o))throw new Error(`'cast' has same keys as 'transform': ${n(t,o)}.`);if(i(s,o))throw new Error(`'replace' has same keys as 'transform': ${n(s,o)}.`);return this}.bind(this)),r(this,lt,function(){return void 0===e(this,ht)||("toObject"in e(this,ht)&&g(e(this,ht).toObject)?r(this,ut,e(this,ht).toObject()):"toJSON"in e(this,ht)&&g(e(this,ht).toJSON)?r(this,ut,e(this,ht).toJSON()):r(this,ut,e(this,ht)),r(this,ut,function(t,e){if(M(t))return e;const r={};return Object.keys(e).forEach(n=>{t.includes(n)||(r[n]=e[n])}),r}(e(this,et),e(this,ut))),r(this,ut,Y(e(this,at),e(this,ut))),r(this,ut,W(e(this,Z),e(this,ut))),r(this,ut,j(e(this,Q),e(this,ut))),r(this,ut,H(e(this,ct),e(this,ut))),r(this,ut,G(e(this,ot),e(this,ut))),r(this,ut,P(e(this,st),e(this,ut))),r(this,ut,N(e(this,X),e(this,ut))),r(this,ut,D(e(this,nt),e(this,ut))),r(this,ut,function(t,e){if(M(t))return e;const r=t.filter(c);if(r.length&&Object.keys(e).forEach(t=>{r.includes(t)&&delete e[t]}),0===R(e).length)return e;const n=t.filter(C);return n.length&&n.forEach(t=>{Object.keys(e).forEach(r=>{t.test(r)&&delete e[r]})}),e}(e(this,tt),e(this,ut))),r(this,ut,k(e(this,ut),e(this,it))),r(this,ut,function(t,e,r=!1){return M(t)?e:q(e,t,r)}(e(this,rt),e(this,ut),e(this,it)))),this}.bind(this)),this.config(t),void 0!==s&&this.data(s)}static factory(t={},e){return new K(t,e)}static get BOOLEAN(){return"boolean"}static get FLAG(){return"flag"}static get NUMERIC(){return"numeric"}static get INTEGER(){return"integer"}static get STRING(){return"string"}static get JSON(){return"json"}getConfig(){return T({cast:e(this,Q),defaults:e(this,X),defined:e(this,Z),exclude:e(this,tt),omit:e(this,et),order:e(this,rt),pick:e(this,nt),sort:e(this,it),rename:e(this,st),replace:e(this,ot),required:e(this,at),transform:e(this,ct)})}resetConfig(){return r(this,Q,{}),r(this,X,{}),r(this,Z,[]),r(this,tt,[]),r(this,et,[]),r(this,rt,[]),r(this,nt,[]),r(this,it,!1),r(this,st,{}),r(this,ot,{}),r(this,at,[]),r(this,ct,{}),this}config(t={}){if(!a(t))throw new TypeError("Config should be an object");const r=function(t,e){const r=new Set(e);return t.filter(t=>!r.has(t))}(R(t),s);if(r.length)throw new TypeError(`Config has unknown fields: '${r.join("', '")}'.`);return this.resetConfig(),this.sort(t.sort),this.omit(t.omit),this.cast(t.cast),this.defined(t.defined),this.pick(t.pick),this.rename(t.rename),this.replace(t.replace),this.required(t.required),this.transform(t.transform),this.defaults(t.defaults),this.exclude(t.exclude),this.order(t.order),e(this,ft).call(this),e(this,lt).call(this),this}cast(t={}){return r(this,Q,h(t)),e(this,ft).call(this),e(this,lt).call(this),this}defaults(t={}){return r(this,X,S(t)),e(this,ft).call(this),e(this,lt).call(this),this}defined(t=[]){return r(this,Z,F(t)),e(this,ft).call(this),e(this,lt).call(this),this}exclude(t=[]){return r(this,tt,I(t)),e(this,ft).call(this),e(this,lt).call(this),this}omit(t=[]){return r(this,et,J(t)),e(this,ft).call(this),e(this,lt).call(this),this}order(t=[]){return r(this,rt,U(t)),e(this,ft).call(this),e(this,lt).call(this),this}pick(t=[]){return r(this,nt,B(t)),e(this,ft).call(this),e(this,lt).call(this),this}rename(t={}){return r(this,st,V(t)),e(this,ft).call(this),e(this,lt).call(this),this}replace(t={}){return r(this,ot,L(t)),e(this,ft).call(this),e(this,lt).call(this),this}required(t=[]){return r(this,at,_(t)),e(this,ft).call(this),e(this,lt).call(this),this}sort(t=!1){if("boolean"!=typeof t)throw new TypeError("'sort' should be a boolean");return r(this,it,t),e(this,lt).call(this),this}transform(t={}){return r(this,ct,z(t)),e(this,ft).call(this),e(this,lt).call(this),this}getData(){return T(e(this,ut))}data(t){if(!a(t))throw new TypeError("Data should be an object");return r(this,ht,t),e(this,lt).call(this),this}clear(){return r(this,ut,{}),r(this,ht,void 0),this}toJSON(){return this.getData()}toString(){return u(this.toJSON())}fromArray(t){return Array.from(t).map(t=>this.data(t).toJSON())}}var Q=new WeakMap,X=new WeakMap,Z=new WeakMap,tt=new WeakMap,et=new WeakMap,rt=new WeakMap,nt=new WeakMap,it=new WeakMap,st=new WeakMap,ot=new WeakMap,at=new WeakMap,ct=new WeakMap,ut=new WeakMap,ht=new WeakMap,ft=new WeakMap,lt=new WeakMap;exports.TYPES_ENUM=t,exports.Vicis=K,exports.cast=function(t,e={}){const r=h(e);return o(r)?t:j(r,t)},exports.defaults=function(t,e={}){return o(S(e))?t:N(e,t)},exports.defined=function(t,e=[]){return M(e)?t:W(e,t)},exports.exclude=function(t,e=[]){const r=I(e);if(M(r))return t;const n=r.filter(c);if(n.length&&Object.keys(t).forEach(e=>{n.includes(e)&&delete t[e]}),0===R(t).length)return t;const i=r.filter(C);return i.length&&i.forEach(e=>{Object.keys(t).forEach(r=>{e.test(r)&&delete t[r]})}),t},exports.omit=function(t,e=[]){const r=J(e);if(M(r))return t;const n={};return Object.keys(t).forEach(e=>{r.includes(e)||(n[e]=t[e])}),n},exports.order=function(t,e=[],r=!1){return M(U(e))?t:q(t,e,r)},exports.pick=function(t,e=[]){const r=B(e);return M(r)?t:D(r,t)},exports.rename=function(t,e={}){const r=V(e);return o(r)?t:P(r,t)},exports.replace=function(t,e={}){const r=L(e);return o(r)?t:G(r,t)},exports.required=function(t,e=[]){const r=_(e);return M(r)?t:Y(r,t)},exports.transform=function(t,e={}){const r=z(e);return o(r)?t:H(r,t)};
//# sourceMappingURL=vicis.cjs.map
